# F16用のスクリプト

ここではF16用のスクリプトの内容およびその使い方について説明します。

**目次**

- [F16用のスクリプト](#f16用のスクリプト)
- [各スクリプトについて](#各スクリプトについて)
- [スクリプトの内容について](#スクリプトの内容について)
- [つかいかた](#つかいかた)
- [で、どうやってゲインを見つければええんや？](#でどうやってゲインを見つければええんや)


# 各スクリプトについて
* auto_simu_gain.ps1: パラメータをランダムで生成してシミュレーションを行います。説明通りのやつです。
* auto_simu_gain_step.ps1: パラメータを少しずつ変化させながらシミュレーションを行いますが…見つかるかどうかは保証しかねます…。

# スクリプトの内容について
PPG用のスクリプトからの変更点は

* パラメータが10個になった
* MATLABの出力の都合上、記録する行数を30行にした

あとはほとんど同じなので省略します。

# つかいかた
これもPPG用のスクリプトと同様です。`parameter_F16.m`を参考に`parameter.m`を編集してください。

# で、どうやってゲインを見つければええんや？
とりあえずGoogleのGemini君に質問してみました。

---

ここからGeminiの出力(一部抜粋)

---

**状態フィードバックゲインの値の範囲**

状態フィードバックゲインの値の範囲は、システムの特性や設計目標によって大きく異なります。一般的に、以下のような要因がゲインの値に影響を与えます。

* **システムの安定性:** システムを安定させるためには、ゲインの値を適切な範囲に設定する必要があります。ゲインが大きすぎると振動が発生し、小さすぎると応答が遅くなります。
* **応答速度:** 応答速度を速くしたい場合は、ゲインを大きくする必要がありますが、その一方で振動が発生しやすくなります。
* **外乱に対するロバスト性:** 外乱の影響を小さくしたい場合は、ゲインを適切に調整する必要があります。

**具体的な範囲**

具体的な範囲を数値で示すことは、システムのモデルや設計条件が不明なため困難です。しかし、一般的には以下のことが言えます。

* **正の値:** 多くの場合、ゲインは正の値となります。負の値になると、システムが不安定になる可能性があります。
* **非常に大きな値:** ゲインが非常に大きい値になると、システムが不安定になる可能性が高くなります。
* **非常に小さな値:** ゲインが非常に小さい値になると、システムの応答が遅くなります。

**ゲインの決定方法**

ゲインの値は、以下の方法によって決定されます。

* **シミュレーション:** シミュレーションによって、様々なゲインの値を試して、最適な値を探します。
* **極配置法:** 目標とする応答特性を実現するように、極の位置を設計し、それに対応するゲインを求めます。
* **最適制御:** 目的関数を設定し、その目的関数を最小化するようなゲインを求めます。

**まとめ**

状態フィードバックゲインの値の範囲は、システムの特性や設計目標によって大きく異なります。具体的な範囲を示すことは困難ですが、一般的にはシステムの安定性、応答速度、外乱に対するロバスト性を考慮して、適切な値を設定する必要があります。


ゲイン調整は、制御システムの設計において非常に重要なステップです。最適なゲイン値を見つけるためには、様々な手法が考えられます。

**ゲイン調整の手法**

1. **シミュレーションによる調整:**
   * **メリット:** 実機を壊すリスクなく、様々なゲイン値を試すことができる。
   * **デメリット:** モデルの精度に依存するため、実際のシステムとの間に誤差が生じる可能性がある。
   * **手順:**
     1. システムの数学モデルを作成する。
     2. シミュレーションソフトウェアを用いて、様々なゲイン値を試す。
     3. ステップ応答、ランプ応答などの応答特性を評価し、最適なゲイン値を見つける。

2. **極配置法:**
   * **メリット:** 目標とする応答特性を直接的に指定できる。
   * **デメリット:** 数学的な知識が必要となる。
   * **手順:**
     1. システムの伝達関数を求める。
     2. 目標とする極の位置を決定する。
     3. 極配置問題を解いて、ゲインを計算する。

3. **LQR制御:**
   * **メリット:** 最適な制御入力を求めることができる。
   * **デメリット:** 目的関数の設定が重要となる。
   * **手順:**
     1. 状態方程式と出力方程式を立てる。
     2. 目的関数を設定する（状態変数の誤差の二乗和などを最小化する）。
     3. リカッチ方程式を解いて、ゲイン行列を求める。

4. **実験による調整:**
   * **メリット:** 実機での動作を確認できる。
   * **デメリット:** 時間と手間がかかる。
   * **手順:**
     1. 小さなゲインから始めて、徐々にゲインを大きくしていく。
     2. システムの応答を観察し、最適なゲイン値を見つける。

**ゲイン調整時の注意点**

* **安定性:** ゲインが大きすぎると、システムが不安定になる可能性がある。
* **応答速度:** ゲインを大きくすると応答速度は速くなるが、オーバーシュートや振動が発生しやすくなる。
* **ロバスト性:** 外乱に対して強いシステムにするためには、ゲインを適切に調整する必要がある。
* **飽和:** アクチュエータの出力範囲を超えないように注意する。

**具体的な手順**

1. **シミュレーション:** まずはシミュレーションで様々なゲイン値を試して、概ねの範囲を把握する。
2. **実験:** シミュレーションの結果を基に、実機で実験を行い、微調整を行う。
3. **評価:** ステップ応答、ランプ応答、外乱に対する応答など、様々な角度から評価を行う。

**その他**

* **自動調整:** MATLABなどのソフトウェアには、自動的にゲインを調整する機能が搭載されている。
* **経験と勘:** ゲイン調整には、経験と勘も重要となる。
* **制御工学の専門家:** 複雑なシステムの制御を行う場合は、制御工学の専門家に相談することをおすすめします。

**まとめ**

ゲイン調整は、試行錯誤を繰り返す作業です。様々な手法を組み合わせながら、最適なゲイン値を見つけていくことが重要です。

---

ここまで

---

…いかがでしたか？これを参考に頑張ってみてください！

まぁこれだけだとちょっと大変そうなのでヒントを書いておくと、自分の場合、各ゲインの値の範囲は$`\pm 1.0`$に収まりました。この範囲の中でランダムに探索しまくればきっと見つかると思いますよ！
